<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>ê°•ì¢Œ ê´€ë¦¬ - ë°”ë¡œêµìœ¡ ê´€ë¦¬ì</title>

    <!-- Google Font: Source Sans Pro -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700&display=fallback">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <!-- AdminLTE -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/admin-lte@3.2/dist/css/adminlte.min.css">
    <!-- DataTables -->
    <link rel="stylesheet" href="https://cdn.datatables.net/1.11.5/css/dataTables.bootstrap4.min.css">
    <!-- Korean Font -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <style>
        body {
            font-family: 'Noto Sans KR', sans-serif;
        }
        .content-wrapper {
            background: #f4f4f4;
        }
        .card {
            box-shadow: 0 0 1px rgba(0,0,0,.125), 0 1px 3px rgba(0,0,0,.2);
            border-radius: .25rem;
        }
        .brand-link {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .sidebar-dark-primary .nav-sidebar > .nav-item > .nav-link.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .course-thumbnail {
            width: 60px;
            height: 40px;
            object-fit: cover;
            border-radius: 4px;
        }
        .status-badge {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 500;
        }
        .status-published {
            background: #d4edda;
            color: #155724;
        }
        .status-draft {
            background: #f8d7da;
            color: #721c24;
        }
        .course-price {
            font-weight: 600;
            color: #007bff;
        }
        .course-rating {
            color: #ffc107;
        }
    </style>
</head>
<body class="hold-transition sidebar-mini">
    <div class="wrapper">
        <!-- ë„¤ë¹„ê²Œì´ì…˜ ë°” -->
        <nav class="main-header navbar navbar-expand navbar-white navbar-light">
            <!-- ì™¼ìª½ ë„¤ë¹„ê²Œì´ì…˜ -->
            <ul class="navbar-nav">
                <li class="nav-item">
                    <a class="nav-link" data-widget="pushmenu" href="#" role="button">
                        <i class="fas fa-bars"></i>
                    </a>
                </li>
            </ul>

            <!-- ì˜¤ë¥¸ìª½ ë„¤ë¹„ê²Œì´ì…˜ -->
            <ul class="navbar-nav ml-auto">
                <li class="nav-item dropdown">
                    <a class="nav-link" data-toggle="dropdown" href="#">
                        <i class="far fa-user"></i>
                        <span class="ml-1" id="admin-name">ê´€ë¦¬ì</span>
                    </a>
                    <div class="dropdown-menu dropdown-menu-lg dropdown-menu-right">
                        <a href="#" class="dropdown-item">
                            <i class="fas fa-user mr-2"></i> í”„ë¡œí•„
                        </a>
                        <div class="dropdown-divider"></div>
                        <a href="#" class="dropdown-item" onclick="logout()">
                            <i class="fas fa-sign-out-alt mr-2"></i> ë¡œê·¸ì•„ì›ƒ
                        </a>
                    </div>
                </li>
            </ul>
        </nav>

        <!-- ë©”ì¸ ì‚¬ì´ë“œë°” -->
        <aside class="main-sidebar sidebar-dark-primary elevation-4">
            <!-- ë¸Œëœë“œ ë¡œê³  -->
            <a href="index.html" class="brand-link">
                <img src="../images/logo.png" alt="ë°”ë¡œêµìœ¡" class="brand-image img-circle elevation-3" style="opacity: .8">
                <span class="brand-text font-weight-light">ë°”ë¡œêµìœ¡ ê´€ë¦¬ì</span>
            </a>

            <!-- ì‚¬ì´ë“œë°” -->
            <div class="sidebar">
                <!-- ì‚¬ì´ë“œë°” ë©”ë‰´ -->
                <nav class="mt-2">
                    <ul class="nav nav-pills nav-sidebar flex-column" data-widget="treeview" role="menu" data-accordion="false">
                        <li class="nav-item">
                            <a href="index.html" class="nav-link">
                                <i class="nav-icon fas fa-tachometer-alt"></i>
                                <p>ëŒ€ì‹œë³´ë“œ</p>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="users.html" class="nav-link">
                                <i class="nav-icon fas fa-users"></i>
                                <p>ì‚¬ìš©ì ê´€ë¦¬</p>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="courses.html" class="nav-link active">
                                <i class="nav-icon fas fa-book"></i>
                                <p>ê°•ì¢Œ ê´€ë¦¬</p>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="reviews.html" class="nav-link">
                                <i class="nav-icon fas fa-star"></i>
                                <p>í›„ê¸° ê´€ë¦¬</p>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="payments.html" class="nav-link">
                                <i class="nav-icon fas fa-credit-card"></i>
                                <p>ê²°ì œ ê´€ë¦¬</p>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="statistics.html" class="nav-link">
                                <i class="nav-icon fas fa-chart-pie"></i>
                                <p>í†µê³„</p>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="settings.html" class="nav-link">
                                <i class="nav-icon fas fa-cogs"></i>
                                <p>ì„¤ì •</p>
                            </a>
                        </li>
                    </ul>
                </nav>
            </div>
        </aside>

        <!-- ì½˜í…ì¸  ë˜í¼ -->
        <div class="content-wrapper">
            <!-- ì½˜í…ì¸  í—¤ë” -->
            <div class="content-header">
                <div class="container-fluid">
                    <div class="row mb-2">
                        <div class="col-sm-6">
                            <h1 class="m-0">ê°•ì¢Œ ê´€ë¦¬</h1>
                        </div>
                        <div class="col-sm-6">
                            <ol class="breadcrumb float-sm-right">
                                <li class="breadcrumb-item"><a href="index.html">í™ˆ</a></li>
                                <li class="breadcrumb-item active">ê°•ì¢Œ ê´€ë¦¬</li>
                            </ol>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ë©”ì¸ ì½˜í…ì¸  -->
            <section class="content">
                <div class="container-fluid">
                    <!-- ê°•ì¢Œ ëª©ë¡ ì¹´ë“œ -->
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">ê°•ì¢Œ ëª©ë¡</h3>
                            <div class="card-tools">
                                <button type="button" class="btn btn-primary btn-sm" onclick="showAddCourseModal()">
                                    <i class="fas fa-plus"></i> ìƒˆ ê°•ì¢Œ ì¶”ê°€
                                </button>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="table-responsive">
                                <table id="courses-table" class="table table-bordered table-striped">
                                    <thead>
                                        <tr>
                                            <th>ì¸ë„¤ì¼</th>
                                            <th>ì œëª©</th>
                                            <th>ê°•ì‚¬</th>
                                            <th>ì¹´í…Œê³ ë¦¬</th>
                                            <th>ê°€ê²©</th>
                                            <th>í‰ì </th>
                                            <th>ìˆ˜ê°•ìƒ</th>
                                            <th>ìƒíƒœ</th>
                                            <th>ìƒì„±ì¼</th>
                                            <th>ì‘ì—…</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <!-- ë™ì ìœ¼ë¡œ ë¡œë“œë¨ -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>

        <!-- í‘¸í„° -->
        <footer class="main-footer">
            <strong>Copyright &copy; 2024 ë°”ë¡œêµìœ¡.</strong>
            All rights reserved.
            <div class="float-right d-none d-sm-inline-block">
                <b>Version</b> 1.0.0
            </div>
        </footer>
    </div>

    <!-- ê°•ì¢Œ ì¶”ê°€/ìˆ˜ì • ëª¨ë‹¬ -->
    <div class="modal fade" id="course-modal" tabindex="-1" role="dialog">
        <div class="modal-dialog modal-lg" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title" id="modal-title">ê°•ì¢Œ ì¶”ê°€</h4>
                    <button type="button" class="close" data-dismiss="modal">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <form id="course-form">
                    <div class="modal-body">
                        <input type="hidden" id="course-id">
                        
                        <div class="row">
                            <div class="col-md-8">
                                <div class="form-group">
                                    <label for="course-title">ê°•ì¢Œ ì œëª© *</label>
                                    <input type="text" class="form-control" id="course-title" required>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label for="course-status">ìƒíƒœ</label>
                                    <select class="form-control" id="course-status">
                                        <option value="draft">ì„ì‹œì €ì¥</option>
                                        <option value="published">ê²Œì‹œ</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="course-instructor">ê°•ì‚¬ëª… *</label>
                                    <input type="text" class="form-control" id="course-instructor" required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="course-category">ì¹´í…Œê³ ë¦¬</label>
                                    <select class="form-control" id="course-category">
                                        <option value="marketing">ë§ˆì¼€íŒ…</option>
                                        <option value="branding">ë¸Œëœë“œ</option>
                                        <option value="development">ì°½ì—…</option>
                                        <option value="crm">CRM</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label for="course-price">ê°€ê²© (ì›)</label>
                                    <input type="number" class="form-control" id="course-price" min="0">
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label for="course-duration">ìˆ˜ê°•ì‹œê°„ (ì‹œê°„)</label>
                                    <input type="number" class="form-control" id="course-duration" min="0">
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-group">
                                    <label for="course-difficulty">ë‚œì´ë„</label>
                                    <select class="form-control" id="course-difficulty">
                                        <option value="beginner">ì´ˆê¸‰</option>
                                        <option value="intermediate">ì¤‘ê¸‰</option>
                                        <option value="advanced">ê³ ê¸‰</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="course-short-description">ì§§ì€ ì„¤ëª…</label>
                            <input type="text" class="form-control" id="course-short-description" maxlength="100">
                        </div>

                        <div class="form-group">
                            <label for="course-description">ìƒì„¸ ì„¤ëª…</label>
                            <textarea class="form-control" id="course-description" rows="4"></textarea>
                        </div>

                        <div class="form-group">
                            <label for="course-thumbnail">ì¸ë„¤ì¼ URL</label>
                            <input type="url" class="form-control" id="course-thumbnail">
                        </div>

                        <div class="form-check">
                            <input type="checkbox" class="form-check-input" id="course-is-free">
                            <label class="form-check-label" for="course-is-free">
                                ë¬´ë£Œ ê°•ì¢Œ
                            </label>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">ì·¨ì†Œ</button>
                        <button type="submit" class="btn btn-primary">ì €ì¥</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!-- Bootstrap 4 -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- AdminLTE -->
    <script src="https://cdn.jsdelivr.net/npm/admin-lte@3.2/dist/js/adminlte.min.js"></script>
    <!-- DataTables -->
    <script src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.11.5/js/dataTables.bootstrap4.min.js"></script>
    <!-- Supabase -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    
    <!-- Supabase ì„¤ì • -->
    <script src="js/supabase-config.js"></script>
    <!-- API í´ë¼ì´ì–¸íŠ¸ -->
    <script src="js/api-client.js"></script>
    
    <script>
        let coursesTable = null;

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', async function() {
            try {
                // ì¸ì¦ í™•ì¸
                const user = await checkAuth();
                
                if (user) {
                    // ì‚¬ìš©ì ì •ë³´ ì—…ë°ì´íŠ¸
                    document.getElementById('admin-name').textContent = user.name || user.email || 'ê´€ë¦¬ì';
                    
                    // ê°•ì¢Œ ê´€ë¦¬ í˜ì´ì§€ ì´ˆê¸°í™”
                    await initCoursesPage();
                    
                    console.log('âœ… ê°•ì¢Œ ê´€ë¦¬ í˜ì´ì§€ ì´ˆê¸°í™” ì™„ë£Œ');
                } else {
                    // ì¸ì¦ ì‹¤íŒ¨ ì‹œ ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ì´ë™
                    window.location.href = 'login.html';
                }
                
            } catch (error) {
                console.error('âŒ í˜ì´ì§€ ì´ˆê¸°í™” ì—ëŸ¬:', error);
                window.location.href = 'login.html';
            }
        });

        // ê°•ì¢Œ ê´€ë¦¬ í˜ì´ì§€ ì´ˆê¸°í™”
        async function initCoursesPage() {
            try {
                // ê°•ì¢Œ í…Œì´ë¸” ì´ˆê¸°í™”
                await initCoursesTable();
                
                // ê°•ì¢Œ ëª©ë¡ ë¡œë“œ
                await loadCourses();
                
                console.log('âœ… ê°•ì¢Œ ê´€ë¦¬ í˜ì´ì§€ ë¡œë“œ ì™„ë£Œ');
            } catch (error) {
                console.error('âŒ ê°•ì¢Œ ê´€ë¦¬ í˜ì´ì§€ ì´ˆê¸°í™” ì—ëŸ¬:', error);
                showToast('ê°•ì¢Œ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
            }
        }

        // ê°•ì¢Œ í…Œì´ë¸” ì´ˆê¸°í™”
        async function initCoursesTable() {
            try {
                if (coursesTable) {
                    coursesTable.destroy();
                }

                coursesTable = $('#courses-table').DataTable({
                    responsive: true,
                    language: {
                        "search": "ê²€ìƒ‰:",
                        "lengthMenu": "_MENU_ ê°œì”© ë³´ê¸°",
                        "info": "_START_ì—ì„œ _END_ê¹Œì§€ (ì´ _TOTAL_ê°œ)",
                        "paginate": {
                            "first": "ì²˜ìŒ",
                            "last": "ë§ˆì§€ë§‰",
                            "next": "ë‹¤ìŒ",
                            "previous": "ì´ì „"
                        },
                        "emptyTable": "ê°•ì¢Œ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.",
                        "zeroRecords": "ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤."
                    },
                    pageLength: 25,
                    order: [[8, 'desc']], // ìƒì„±ì¼ ê¸°ì¤€ ë‚´ë¦¼ì°¨ìˆœ
                    columnDefs: [
                        { targets: [0, 9], orderable: false }, // ì¸ë„¤ì¼, ì‘ì—… ì»¬ëŸ¼ ì •ë ¬ ë¹„í™œì„±í™”
                        { targets: [4], className: 'text-right' }, // ê°€ê²© ì»¬ëŸ¼ ìš°ì¸¡ ì •ë ¬
                        { targets: [5, 6], className: 'text-center' }, // í‰ì , ìˆ˜ê°•ìƒ ì»¬ëŸ¼ ì¤‘ì•™ ì •ë ¬
                        { targets: [8], type: 'date' } // ìƒì„±ì¼ ì»¬ëŸ¼
                    ]
                });
                
                console.log('âœ… ê°•ì¢Œ í…Œì´ë¸” ì´ˆê¸°í™” ì™„ë£Œ');
            } catch (error) {
                console.error('ê°•ì¢Œ í…Œì´ë¸” ì´ˆê¸°í™” ì—ëŸ¬:', error);
            }
        }

        // ê°•ì¢Œ ëª©ë¡ ë¡œë“œ
        async function loadCourses() {
            try {
                console.log('ğŸ”„ ê°•ì¢Œ ëª©ë¡ ë¡œë“œ ì¤‘...');
                
                // Supabaseì—ì„œ ê°•ì¢Œ ëª©ë¡ ê°€ì ¸ì˜¤ê¸°
                const { data: courses, error } = await supabase
                    .from('courses')
                    .select('*')
                    .order('created_at', { ascending: false });

                if (error) {
                    console.warn('ê°•ì¢Œ ëª©ë¡ ì¡°íšŒ ì—ëŸ¬:', error);
                    // ì—ëŸ¬ ì‹œ ìƒ˜í”Œ ë°ì´í„° í‘œì‹œ
                    displaySampleCourses();
                    return;
                }

                if (coursesTable) {
                    coursesTable.clear();
                    
                    if (courses && courses.length > 0) {
                        courses.forEach(course => {
                            const row = createCourseRow(course);
                            coursesTable.row.add(row);
                        });
                    }
                    
                    coursesTable.draw();
                }
                
                console.log(`âœ… ê°•ì¢Œ ${courses?.length || 0}ê°œ ë¡œë“œ ì™„ë£Œ`);
            } catch (error) {
                console.error('ê°•ì¢Œ ëª©ë¡ ë¡œë“œ ì—ëŸ¬:', error);
                displaySampleCourses();
            }
        }

        // ì‹¤ì œ ê°•ì¢Œ ë°ì´í„° í‘œì‹œ (ë°”ë¡œêµìœ¡ ì‚¬ì´íŠ¸ ê¸°ë°˜)
        function displaySampleCourses() {
            if (!coursesTable) return;

            const realCourses = [
                {
                    id: '1',
                    title: 'SNS ë§ˆì¼€íŒ… ë§ˆìŠ¤í„°',
                    instructor: 'ê¹€ë§ˆì¼€íŒ…',
                    category: 'marketing',
                    price: 99000,
                    rating: 4.8,
                    students: 150,
                    status: 'published',
                    thumbnail: '../images/pd1.jpg',
                    created_at: '2024-01-15T10:30:00Z'
                },
                {
                    id: '2',
                    title: 'AI ìƒì„¸í˜ì´ì§€ ìµœì í™”',
                    instructor: 'ì´ë””ìì¸',
                    category: 'branding',
                    price: 0,
                    rating: 4.5,
                    students: 89,
                    status: 'published',
                    thumbnail: '../images/pd2.jpg',
                    created_at: '2024-01-10T15:45:00Z'
                },
                {
                    id: '3',
                    title: 'ë°”ì´ëŸ´ ì½˜í…ì¸  ê¸°ì´ˆë¶€í„° ì‹¤ì „',
                    instructor: 'ë°•ë°”ì´ëŸ´',
                    category: 'marketing',
                    price: 149000,
                    rating: 4.9,
                    students: 203,
                    status: 'published',
                    thumbnail: '../images/pd3.jpg',
                    created_at: '2024-01-08T11:20:00Z'
                },
                {
                    id: '4',
                    title: 'ì‡¼í•‘ëª° ì°½ì—… A to Z',
                    instructor: 'ìµœì°½ì—…',
                    category: 'development',
                    price: 199000,
                    rating: 4.7,
                    students: 132,
                    status: 'published',
                    thumbnail: '../images/pd4.jpg',
                    created_at: '2024-01-05T14:20:00Z'
                },
                {
                    id: '5',
                    title: 'ê³ ê° ê´€ë¦¬ ì‹œìŠ¤í…œ êµ¬ì¶•',
                    instructor: 'ì •ì‹œìŠ¤í…œ',
                    category: 'crm',
                    price: 129000,
                    rating: 4.6,
                    students: 78,
                    status: 'published',
                    thumbnail: '../images/pd11.jpg',
                    created_at: '2024-01-03T09:15:00Z'
                },
                {
                    id: '6',
                    title: 'ë¸Œëœë”© ì „ëµ ìˆ˜ë¦½',
                    instructor: 'ê¹€ë¸Œëœë“œ',
                    category: 'branding',
                    price: 179000,
                    rating: 4.8,
                    students: 95,
                    status: 'published',
                    thumbnail: '../images/pd12.jpg',
                    created_at: '2024-01-02T16:30:00Z'
                },
                {
                    id: '7',
                    title: 'ì˜¨ë¼ì¸ ë§ˆì¼€íŒ… ì „ëµ',
                    instructor: 'ì´ì˜¨ë¼ì¸',
                    category: 'marketing',
                    price: 0,
                    rating: 4.4,
                    students: 234,
                    status: 'published',
                    thumbnail: '../images/pd13.jpg',
                    created_at: '2024-01-01T11:45:00Z'
                },
                {
                    id: '8',
                    title: 'ìŠ¤íƒ€íŠ¸ì—… ì‚¬ì—…ê³„íšì„œ ì‘ì„±',
                    instructor: 'ë°•ì‚¬ì—…',
                    category: 'development',
                    price: 89000,
                    rating: 4.5,
                    students: 67,
                    status: 'draft',
                    thumbnail: '../images/pd14.jpg',
                    created_at: '2023-12-30T13:20:00Z'
                },
                {
                    id: '9',
                    title: 'ì†Œì…œë¯¸ë””ì–´ ìš´ì˜ ì „ëµ',
                    instructor: 'ìµœì†Œì…œ',
                    category: 'marketing',
                    price: 119000,
                    rating: 4.7,
                    students: 156,
                    status: 'published',
                    thumbnail: '../images/portfolio2.jpg',
                    created_at: '2023-12-28T10:10:00Z'
                },
                {
                    id: '10',
                    title: 'ì›¹ë””ìì¸ ê¸°ì´ˆ',
                    instructor: 'ê¹€ì›¹ë””',
                    category: 'branding',
                    price: 79000,
                    rating: 4.3,
                    students: 112,
                    status: 'published',
                    thumbnail: '../images/webdesign.png',
                    created_at: '2023-12-25T15:30:00Z'
                }
            ];

            coursesTable.clear();
            realCourses.forEach(course => {
                const row = createCourseRow(course);
                coursesTable.row.add(row);
            });
            coursesTable.draw();

            showToast('ì‹¤ì œ ë°”ë¡œêµìœ¡ ê°•ì¢Œ ë°ì´í„°ë¥¼ í‘œì‹œí•©ë‹ˆë‹¤.', 'success');
        }

        // ê°•ì¢Œ í–‰ ìƒì„±
        function createCourseRow(course) {
            const thumbnail = course.thumbnail ? 
                `<img src="${course.thumbnail}" alt="ì¸ë„¤ì¼" class="course-thumbnail">` : 
                `<div class="course-thumbnail bg-secondary d-flex align-items-center justify-content-center">
                    <i class="fas fa-book text-white"></i>
                </div>`;
            
            const title = course.title || 'ì œëª© ì—†ìŒ';
            const instructor = course.instructor || 'ê°•ì‚¬ ë¯¸ì •';
            const category = getCategoryName(course.category);
            const price = course.price > 0 ? 
                `<span class="course-price">${Number(course.price).toLocaleString()}ì›</span>` : 
                '<span class="badge badge-success">ë¬´ë£Œ</span>';
            
            const rating = course.rating ? 
                `<span class="course-rating">
                    <i class="fas fa-star"></i> ${course.rating}
                </span>` : 
                '<span class="text-muted">í‰ê°€ ì—†ìŒ</span>';
            
            const students = course.students || 0;
            
            const status = course.status === 'published' ? 
                '<span class="badge badge-success">ê²Œì‹œ</span>' : 
                '<span class="badge badge-warning">ì„ì‹œì €ì¥</span>';
            
            const createdAt = course.created_at ? db.formatDate(course.created_at) : 'ë‚ ì§œ ì—†ìŒ';
            
            const actions = `
                <div class="btn-group btn-group-sm">
                    <button class="btn btn-info" onclick="viewCourse('${course.id}')" title="ìƒì„¸ë³´ê¸°">
                        <i class="fas fa-eye"></i>
                    </button>
                    <button class="btn btn-warning" onclick="editCourse('${course.id}')" title="ìˆ˜ì •">
                        <i class="fas fa-edit"></i>
                    </button>
                    <button class="btn btn-danger" onclick="deleteCourse('${course.id}')" title="ì‚­ì œ">
                        <i class="fas fa-trash"></i>
                    </button>
                </div>
            `;

            return [thumbnail, title, instructor, category, price, rating, students, status, createdAt, actions];
        }

        // ì¹´í…Œê³ ë¦¬ ì´ë¦„ ë³€í™˜
        function getCategoryName(category) {
            const categories = {
                'marketing': 'ë§ˆì¼€íŒ…',
                'branding': 'ë¸Œëœë“œ',
                'development': 'ì°½ì—…',
                'crm': 'CRM'
            };
            return categories[category] || category || 'ê¸°íƒ€';
        }

        // ìƒˆ ê°•ì¢Œ ì¶”ê°€ ëª¨ë‹¬ í‘œì‹œ
        function showAddCourseModal() {
            document.getElementById('modal-title').textContent = 'ìƒˆ ê°•ì¢Œ ì¶”ê°€';
            document.getElementById('course-form').reset();
            document.getElementById('course-id').value = '';
            $('#course-modal').modal('show');
        }

        // ê°•ì¢Œ ìƒì„¸ë³´ê¸°
        function viewCourse(courseId) {
            showToast('ê°•ì¢Œ ìƒì„¸ë³´ê¸° ê¸°ëŠ¥ì€ ì¤€ë¹„ ì¤‘ì…ë‹ˆë‹¤.', 'info');
        }

        // ê°•ì¢Œ ìˆ˜ì •
        function editCourse(courseId) {
            showToast('ê°•ì¢Œ ìˆ˜ì • ê¸°ëŠ¥ì€ ì¤€ë¹„ ì¤‘ì…ë‹ˆë‹¤.', 'info');
        }

        // ê°•ì¢Œ ì‚­ì œ
        function deleteCourse(courseId) {
            if (confirm('ì •ë§ë¡œ ì´ ê°•ì¢Œë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                showToast('ê°•ì¢Œ ì‚­ì œ ê¸°ëŠ¥ì€ ì¤€ë¹„ ì¤‘ì…ë‹ˆë‹¤.', 'info');
            }
        }

        // ê°•ì¢Œ í¼ ì œì¶œ
        document.getElementById('course-form').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            try {
                const courseData = {
                    title: document.getElementById('course-title').value,
                    instructor: document.getElementById('course-instructor').value,
                    category: document.getElementById('course-category').value,
                    price: parseInt(document.getElementById('course-price').value) || 0,
                    duration: parseInt(document.getElementById('course-duration').value) || 0,
                    difficulty: document.getElementById('course-difficulty').value,
                    short_description: document.getElementById('course-short-description').value,
                    description: document.getElementById('course-description').value,
                    thumbnail: document.getElementById('course-thumbnail').value,
                    status: document.getElementById('course-status').value,
                    is_free: document.getElementById('course-is-free').checked
                };

                const courseId = document.getElementById('course-id').value;
                
                if (courseId) {
                    // ìˆ˜ì • ë¡œì§
                    showToast('ê°•ì¢Œ ìˆ˜ì • ê¸°ëŠ¥ì€ ì¤€ë¹„ ì¤‘ì…ë‹ˆë‹¤.', 'info');
                } else {
                    // ì¶”ê°€ ë¡œì§
                    showToast('ê°•ì¢Œ ì¶”ê°€ ê¸°ëŠ¥ì€ ì¤€ë¹„ ì¤‘ì…ë‹ˆë‹¤.', 'info');
                }
                
                $('#course-modal').modal('hide');
                
            } catch (error) {
                console.error('ê°•ì¢Œ ì €ì¥ ì—ëŸ¬:', error);
                showToast('ê°•ì¢Œ ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
            }
        });

        // í† ìŠ¤íŠ¸ ë©”ì‹œì§€ í‘œì‹œ
        function showToast(message, type = 'success') {
            const existingToast = document.getElementById('courses-toast');
            if (existingToast) {
                existingToast.remove();
            }

            const toast = document.createElement('div');
            toast.id = 'courses-toast';
            toast.className = `alert alert-${type === 'error' ? 'danger' : type} position-fixed`;
            toast.style.cssText = `
                top: 20px;
                right: 20px;
                z-index: 9999;
                min-width: 300px;
                border-radius: 8px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            `;
            toast.innerHTML = `
                <div class="d-flex align-items-center">
                    <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-triangle' : 'info-circle'} mr-2"></i>
                    <span>${message}</span>
                    <button type="button" class="close ml-auto" onclick="this.parentElement.parentElement.remove()">
                        <span>&times;</span>
                    </button>
                </div>
            `;

            document.body.appendChild(toast);

            setTimeout(() => {
                if (toast && toast.parentNode) {
                    toast.remove();
                }
            }, 3000);
        }
    </script>
</body>
</html> 